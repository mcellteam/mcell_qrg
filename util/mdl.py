import re

from pygments.lexer import inherit, words
from pygments.token import Operator, Keyword

from pygments.lexers.c_cpp import CLexer

__all__ = ['MdlLexer']

class MdlLexer(CLexer):
    name = 'Mdl'
    aliases = ['mdl']
    filenames = ['*.mdl']

    tokens = {
        'statements': [
            (words((
                "OBJECT", "ITERATIONS", "TIME_STEP", "ABS",
                "ACCURATE_3D_REACTIONS", "ACOS", "ALL_DATA", "ALL_CROSSINGS",
                "ALL_ELEMENTS", "ALL_ENCLOSED", "ALL_EVENTS", "ALL_HITS",
                "ALL_ITERATIONS", "ALL_MESHES", "ALL_MOLECULES",
                "ALL_NOTIFICATIONS", "ALL_TIMES", "ALL_WARNINGS",
                "AREA_OCCUPIED", "ASCII", "ASIN", "ASPECT_RATIO", "ATAN",
                "BACK", "BACK_CROSSINGS", "BACK_HITS", "BINDING_POLE",
                "BOTH_POLES", "BOTTOM", "BOX", "BOX_TRIANGULATION_REPORT",
                "BRIEF", "CEIL", "CENTER_MOLECULES_ON_GRID", "CHARGE",
                "CHECKPOINT_INFILE", "CHECKPOINT_OUTFILE",
                "CHECKPOINT_ITERATIONS", "CLAMP", "CLAMP_CONC",
                "CLAMP_CONCENTRATION", "CLOSE_PARTITION_SPACING", "COLOR",
                "COLOR_EFFECTOR", "COLOR_SIDE", "COMPARTMENT", "CORNERS",
                "COS", "CONC", "CONCENTRATION", "COUNT", "CUBIC",
                "CUBIC_RELEASE_SITE", "CUSTOM_SPACE_STEP", "CUSTOM_RK",
                "CUSTOM_TIME_STEP", "CUMULATE_FOR_EACH_TIME_STEP", "D_3D",
                "DIFFUSION_CONSTANT", "DIFFUSION_CONSTANT_3D", "D_2D",
                "DIFFUSION_CONSTANT_2D", "DEFINE",
                "DEFINE_EFFECTOR_SITE_POSITIONS", "DEFINE_MOLECULE",
                "DEFINE_MOLECULES", "DEFINE_REACTIONS",
                "DEFINE_RELEASE_PATTERN", "DEFINE_SURFACE_REGIONS",
                "DEFINE_SURFACE_CLASS", "DEFINE_SURFACE_CLASSES",
                "DEGENERATE_POLYGONS", "DELAY", "DENSITY",
                "DIFFUSION_CONSTANT_REPORTS", "DX", "DREAMM_V3",
                "DREAMM_V3_GROUPED", "EFFECTOR", "EFFECTOR_GRID_DENSITY",
                "SURFACE_GRID_DENSITY", "EFFECTOR_POSITIONS", "EFFECTOR_STATE",
                "EFFECTOR_STATES", "EITHER_POLE", "ELEMENT",
                "ELEMENT_CONNECTIONS", "ELEMENT_LIST", "ELLIPTIC",
                "ELLIPTIC_RELEASE_SITE", "ERROR", "ESTIMATE_CONC",
                "ESTIMATE_CONCENTRATION", "EXCLUDE_ELEMENTS", "EXCLUDE_PATCH",
                "EXCLUDE_REGION", "EXP", "EXPRESSION", "FALSE", "FILENAME",
                "FILE_OUTPUT_REPORT", "FINAL_SUMMARY", "FLOOR",
                "FOR_EACH_TIME_STEP", "FOR_EACH_MOLECULE", "FOR_EACH_LIGAND",
                "FOR_EACH_EFFECTOR", "FRAME_DATA", "FRONT", "FRONT_CROSSINGS",
                "FRONT_HITS", "FULLY_RANDOM", "GAUSSIAN_RELEASE_NUMBER",
                "GEOMETRY", "HEADER", "HIGH_PROBABILITY_THRESHOLD",
                "HIGH_REACTION_PROBABILITY", "IGNORE", "IGNORED",
                "INCLUDE_ELEMENTS", "INCLUDE_FILE", "INCLUDE_PATCH",
                "INCLUDE_REGION", "INITIAL_EVENTS", "INPUT_FILE",
                "INSTANTIATE", "INTERACTION_RADIUS", "INTERIM_EVENTS", "IRIT",
                "ITERATIONS", "ITERATION_FRAME_DATA", "ITERATION_LIST",
                "ITERATION_NUMBERS", "ITERATION_REPORT", "LEFT",
                "LIFETIME_TOO_SHORT", "LIFETIME_THRESHOLD", "LIST", "LOCATION",
                "LOG10", "LOG", "MAX", "MCELL_GENERIC", "MEAN_DIAMETER",
                "MEAN_NUMBER", "MESHES", "MICRO_REV_SURF_RX",
                "MICRO_REV_VOL_RX", "MIN", "MISSED_REACTIONS",
                "MISSED_REACTION_THRESHOLD", "MISSING_SURFACE_ORIENTATION",
                "MOD", "MODE", "MODIFY_SURFACE_REGIONS", "MOLECULE_DENSITY",
                "MOLECULE_NUMBER", "MOLECULE", "LIGAND", "MOLECULES",
                "MOLECULE_POSITIONS", "LIGAND_POSITIONS", "MOLECULE_STATES",
                "LIGAND_STATES", "MOLECULE_POSITIONS_STATES",
                "MOLECULE_FILE_PREFIX", "NAME", "NAME_LIST",
                "NEGATIVE_DIFFUSION_CONSTANT", "NEGATIVE_REACTION_RATE",
                "NEGATIVE_POLE", "NORMAL", "NO", "NONE", "NOTIFICATIONS",
                "NULL", "NUMBER", "NUMBER_BOUND", "NUMBER_OF_TRAINS",
                "NUMBER_TO_RELEASE", "OBJECT", "OBJECT_FILE_PREFIXES", "OFF",
                "ON", "ORIENTATION", "ORIENTATIONS", "OUTPUT_BUFFER_SIZE",
                "OVERWRITTEN_OUTPUT_FILE", "PARALLEL_PARTITION", "PART",
                "PARTITION_LOCATION_REPORT", "PARTITION_X", "PARTITION_Y",
                "PARTITION_Z", "PARTS", "PI", "POLE_ORIENTATION",
                "POLYGON_LIST", "POSITIONS", "POSITIVE_BACK", "POSITIVE_FRONT",
                "POSITIVE_POLE", "PROBABILITY_REPORT",
                "PROBABILITY_REPORT_THRESHOLD", "POVRAY", "PROGRESS_REPORT",
                "RADIAL_DIRECTIONS", "RADIAL_SUBDIVISIONS", "RADIANCE",
                "RAND_UNIFORM", "RAND_GAUSSIAN", "RAYSHADE",
                "REACTION_DATA_OUTPUT", "REACTION_GROUP", "RECTANGULAR",
                "RECTANGULAR_RELEASE_SITE", "REFERENCE_DIFFUSION_CONSTANT",
                "REFERENCE_STATE", "REGION_DATA", "RELEASE_EVENT_REPORT",
                "RELEASE_INTERVAL", "RELEASE_PATTERN", "RELEASE_PROBABILITY",
                "RELEASE_SITE", "REMOVE_ELEMENTS", "RENDERMAN", "RIGHT",
                "ROTATE", "ROUND_OFF", "SCALE", "SEED", "SHAPE", "SIN",
                "SITE_DIAMETER", "SITE_RADIUS", "SPACE_STEP",
                "SPECIFIED_MOLECULES", "SPECIFIED_LIGANDS",
                "SPECIFIED_EFFECTORS", "SPHERICAL", "SPHERICAL_RELEASE_SITE",
                "SPHERICAL_SHELL", "SPHERICAL_SHELL_SITE", "SQRT",
                "STANDARD_DEVIATION", "STATE_VALUES", "STATE", "STEP",
                "STRING_TO_NUM", "SUM", "SUM_OVER_ALL_MOLECULES",
                "SUM_OVER_ALL_LIGANDS", "SUM_OVER_ALL_EFFECTORS",
                "SUM_OVER_ALL_TIME_STEPS", "SURFACE_CLASS",
                "SURFACE_MOLECULE_AREA", "SURFACE_POSITIONS", "SURFACE_STATES",
                "TAN", "TARGET_ONLY", "TET_ELEMENT_CONNECTIONS", "TIME_LIST",
                "TIME_POINTS", "TIME_STEP", "TIME_STEP_MAX", "TO", "TOP",
                "TRAIN_DURATION", "TRAIN_INTERVAL", "TRANSFORM", "TRANSLATE",
                "TRIGGER", "TRUE", "UNLIMITED", "VACANCY_SEARCH_DISTANCE",
                "USELESS_VOLUME_ORIENTATION", "VERTEX_LIST", "VIZ_DATA_OUTPUT",
                "VIZ_OUTPUT", "VIZ_VALUE", "VOLUME_DEPENDENT_RELEASE_NUMBER",
                "VOXEL_IMAGE_MODE", "VOXEL_LIST", "VOXEL_VOLUME_MODE",
                "WARNING", "WARNINGS", "WORLD", "YES"), suffix=r'\b'),
             Keyword),
            (r"[,';+-/=@]", Operator),
            inherit,
        ],
    }
